---
description: React Design Patterns - Container/Presentational, Hooks, Component Patterns
globs:
  - "**/*.tsx"
  - "**/*.ts"
alwaysApply: true
---

# React Design Patterns

**Reference:** https://www.patterns.dev/react/

---

## ğŸ¯ MANDATORY: Container/Presentational Pattern

**Reference:** https://www.patterns.dev/react/presentational-container-pattern/

Every screen/page MUST follow this pattern. This is NON-NEGOTIABLE.

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pages/[Feature].tsx (CONTAINER)                                    â”‚
â”‚                                                                     â”‚
â”‚  Responsibilities:                                                  â”‚
â”‚  â€¢ State management (useState, useReducer)                          â”‚
â”‚  â€¢ Data fetching (useQuery, useMutation)                            â”‚
â”‚  â€¢ Business logic                                                   â”‚
â”‚  â€¢ Event handlers                                                   â”‚
â”‚  â€¢ Loading/Error/Empty states                                       â”‚
â”‚  â€¢ Passes data as props to View                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ props (data + callbacks)
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  components/[feature]/index.tsx (PRESENTATIONAL VIEW)               â”‚
â”‚                                                                     â”‚
â”‚  Responsibilities:                                                  â”‚
â”‚  â€¢ UI rendering ONLY                                                â”‚
â”‚  â€¢ Receives all data via props                                      â”‚
â”‚  â€¢ NO state (unless UI-only like hover, open)                       â”‚
â”‚  â€¢ NO API calls                                                     â”‚
â”‚  â€¢ Composes child components                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼             â–¼             â–¼                 â–¼
  Child.tsx    Child.tsx    Child.tsx         Child.tsx
  (UI only)    (UI only)    (UI only)         (UI only)
```

### Folder Structure for Each Feature

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ StudentPortfolio.tsx      â† CONTAINER (state, API, logic)
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ student-portfolio/        â† PRESENTATIONAL folder
â”‚       â”œâ”€â”€ ProfileAvatar.tsx     â† Pure UI component
â”‚       â”œâ”€â”€ ProfileInfo.tsx       â† Pure UI component
â”‚       â”œâ”€â”€ ProfileBio.tsx        â† Pure UI component
â”‚       â”œâ”€â”€ AssignmentsGrid.tsx   â† Pure UI component
â”‚       â””â”€â”€ index.tsx             â† Composes all UI (View)
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ student-portfolio.ts      â† All types for this feature
â”‚
â””â”€â”€ query-key/
    â””â”€â”€ student-portfolio.ts      â† Query keys for this feature
```

### Container Component Rules

```typescript
// âœ… CORRECT Container (pages/Feature.tsx)
function FeaturePage() {
  // 1. State
  const [filter, setFilter] = useState("");
  
  // 2. Data fetching
  const { data, isLoading, error } = useQuery({
    queryKey: FEATURE_KEYS.list(),
    queryFn: fetchData,
  });
  
  // 3. Callbacks
  const handleClick = useCallback(() => {
    // logic here
  }, []);
  
  // 4. Loading/Error states (in container, not view)
  if (isLoading) return <Loading />;
  if (error) return <Error />;
  
  // 5. Pass everything as props to View
  return (
    <FeatureView
      data={data}
      filter={filter}
      onFilterChange={setFilter}
      onItemClick={handleClick}
    />
  );
}
```

### Presentational Component Rules

```typescript
// âœ… CORRECT Presentational (components/feature/index.tsx)
interface FeatureViewProps {
  data: Item[];
  filter: string;
  onFilterChange: (value: string) => void;
  onItemClick: (id: string) => void;
  className?: string; // Allow style customization
}

function FeatureView({ data, filter, onFilterChange, onItemClick, className }: FeatureViewProps) {
  // NO useState (unless UI-only like dropdown open)
  // NO useQuery
  // NO useEffect for data
  // ONLY render UI
  
  return (
    <div className={cn("default-styles", className)}>
      <SearchBar value={filter} onChange={onFilterChange} />
      <ItemList items={data} onItemClick={onItemClick} />
    </div>
  );
}
```

---

## ğŸ¨ Reusable Component Pattern

**All presentational components MUST support style customization.**

### Simple Components â†’ `className` prop

```typescript
interface ProfileAvatarProps {
  image: string | null;
  name: string;
  className?: string;  // â† REQUIRED for simple components
}

function ProfileAvatar({ image, name, className }: ProfileAvatarProps) {
  return (
    <div className={cn("h-20 w-20 rounded-full", className)}>
      {/* content */}
    </div>
  );
}
```

### Complex Components â†’ `classNames` object prop

```typescript
interface ProfileInfoClassNames {
  container?: string;
  title?: string;
  badge?: string;
}

interface ProfileInfoProps {
  name: string;
  grade: string;
  classNames?: ProfileInfoClassNames;  // â† REQUIRED for complex components
}

function ProfileInfo({ name, grade, classNames }: ProfileInfoProps) {
  return (
    <div className={cn("", classNames?.container)}>
      <h3 className={cn("text-3xl font-bold", classNames?.title)}>{name}</h3>
      <span className={cn("text-sm", classNames?.badge)}>{grade}</span>
    </div>
  );
}
```

---

## ğŸª Hooks Pattern

**Reference:** https://www.patterns.dev/react/hooks-pattern/

### Custom Hooks for Data Fetching

```typescript
// âœ… CORRECT - Custom hook encapsulates data logic
// hooks/useStudentPortfolio.ts
export function useStudentPortfolio(studentId: string) {
  const studentQuery = useQuery({
    queryKey: STUDENT_PORTFOLIO_KEYS.studentInfo(studentId),
    queryFn: () => getProfileInfo(studentId),
  });
  
  const assignmentsQuery = useQuery({
    queryKey: STUDENT_PORTFOLIO_KEYS.approvedAssignments(studentId),
    queryFn: () => getApprovedAssignments(studentId),
  });
  
  return {
    student: studentQuery.data,
    assignments: assignmentsQuery.data,
    isLoading: studentQuery.isLoading || assignmentsQuery.isLoading,
    error: studentQuery.error || assignmentsQuery.error,
  };
}
```

---

## ğŸ§© Compound Component Pattern

**Reference:** https://www.patterns.dev/react/compound-pattern/

Use for related components that work together:

```typescript
// âœ… CORRECT - Compound components
<Card>
  <Card.Header>
    <Card.Title>Title</Card.Title>
  </Card.Header>
  <Card.Content>Content here</Card.Content>
  <Card.Footer>Footer</Card.Footer>
</Card>
```

---

## ğŸ“‹ Pattern Selection Guide

When asked to build a new screen/feature, follow this decision tree:

```
New Feature Request
â”‚
â”œâ”€â”€ Is it a page/screen?
â”‚   â””â”€â”€ YES â†’ Use Container/Presentational Pattern
â”‚       â”œâ”€â”€ Create pages/[Feature].tsx (container)
â”‚       â”œâ”€â”€ Create components/[feature]/ folder (presentational)
â”‚       â”œâ”€â”€ Create types/[feature].ts
â”‚       â””â”€â”€ Create query-key/[feature].ts
â”‚
â”œâ”€â”€ Is it reusable logic?
â”‚   â””â”€â”€ YES â†’ Use Hooks Pattern
â”‚       â””â”€â”€ Create hooks/use[Feature].ts
â”‚
â”œâ”€â”€ Is it a group of related components?
â”‚   â””â”€â”€ YES â†’ Consider Compound Pattern
â”‚
â””â”€â”€ Is it a simple UI element?
    â””â”€â”€ YES â†’ Create single component with className prop
```

---

## âŒ Anti-Patterns (NEVER DO)

```typescript
// âŒ BAD: Mixing data fetching with UI
function UserCard({ userId }) {
  const { data } = useQuery(['user', userId], fetchUser); // NO!
  return <div>{data?.name}</div>;
}

// âŒ BAD: Prop drilling instead of composition
<Parent data={data}>
  <Child data={data}>
    <GrandChild data={data} /> // NO! Too deep
  </Child>
</Parent>

// âŒ BAD: No style customization
function Button({ children }) {
  return <button className="fixed-styles">{children}</button>; // NO!
}

// âŒ BAD: Business logic in presentational component
function ItemList({ items }) {
  const filtered = items.filter(i => i.active); // NO! Do in container
  return <div>{filtered.map(...)}</div>;
}
```

---

## âœ… Pre-Implementation Checklist

Before building any screen/feature:

- [ ] Identified Container component (page)
- [ ] Identified Presentational components (UI folder)
- [ ] Created types file for the feature
- [ ] Created query-key file for API calls
- [ ] All presentational components have className/classNames props
- [ ] No data fetching in presentational components
- [ ] Loading/Error states handled in container
